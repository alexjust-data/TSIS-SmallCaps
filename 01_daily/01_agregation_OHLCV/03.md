```sh
$env:POLYGON_API_KEY = "G4fe7xkLNVEWmWeVHcuXx73P2gfRE6mN"; python -c "
import requests
import os
import time

api_key = os.environ['POLYGON_API_KEY']

# Tickers de tu lista de missing
test_tickers = ['MED', 'MGN', 'MIW', 'MJI', 'MLR', 'MPB', 'MPX', 'MTS', 'NAT', 'NBG']

print('=== TEST TICKERS MISSING - DISPONIBILIDAD 2004 vs 2011 ===\n')

for ticker in test_tickers:
    # Test 2004
    url_2004 = f'https://api.polygon.io/v2/aggs/ticker/{ticker}/range/1/day/2004-01-02/2004-01-10'
    r_2004 = requests.get(url_2004, params={'apiKey': api_key}, timeout=10)
    data_2004 = r_2004.json()
    count_2004 = data_2004.get('resultsCount', 0)
    
    time.sleep(0.08)
    
    # Test 2011
    url_2011 = f'https://api.polygon.io/v2/aggs/ticker/{ticker}/range/1/day/2011-10-17/2011-10-25'
    r_2011 = requests.get(url_2011, params={'apiKey': api_key}, timeout=10)
    data_2011 = r_2011.json()
    count_2011 = data_2011.get('resultsCount', 0)
    
    print(f'{ticker:6} | 2004: {count_2004:2} días | 2011: {count_2011:2} días | Status: {data_2004.get(\"status\", \"ERROR\")}')
    
    # Si hay datos en 2004, mostrar el primer precio
    if count_2004 > 0 and 'results' in data_2004:
        result = data_2004['results'][0]
        t_date = result.get('t', 0)
        from datetime import datetime
        date_str = datetime.fromtimestamp(t_date/1000).strftime('%Y-%m-%d')
        print(f'       2004: {date_str} C={result.get(\"c\")} V={result.get(\"v\")}')
    
    time.sleep(0.08)
    print()
```


```sh
powershell -Command "$env:POLYGON_API_KEY = 'G4fe7xkLNVEWmWeVHcuXx73P2gfRE6mN'; python -c `\"
import requests
import os
import time

api_key = os.environ['POLYGON_API_KEY']

# Tickers de tu lista de missing
test_tickers = ['MED', 'MGN', 'MIW', 'MJI', 'MLR', 'MPB', 'MPX', 'MTS', 'NAT', 'NBG']

print('=== TEST TICKERS MISSING - DISPONIBILIDAD 2004 vs 2011 ===\n')

for ticker in test_tickers:
    # Test 2004
    url_2004 = f'https://api.polygon.io/v2/aggs/ticker/{ticker}/range/1/day/2004-01-02/2004-01-10'
    r_2004 = requests.get(url_2004, params={'apiKey': api_key}, timeout=10)
    data_2004 = r_2004.json()
    count_2004 = data_2004.get('resultsCount', 0)
    
    time.sleep(0.08)
    
    # Test 2011
    url_2011 = f'https://api.polygon.io/v2/aggs/ticker/{ticker}/range/1/day/2011-10-17/2011-10-25'
    r_2011 = requests.get(url_2011, params={'apiKey': api_key}, timeout=10)
    data_2011 = r_2011.json()
    count_2011 = data_2011.get('resultsCount', 0)
    
    print(f'{ticker:6} | 2004: {count_2004:2} días | 2011: {count_2011:2} días | Status: {data_2004.get(\"status\", \"ERROR\")}')
    
    # Si hay datos en 2004, mostrar el primer precio
    if count_2004 > 0 and 'results' in data_2004:
        result = data_2004['results'][0]
        t_date = result.get('t', 0)
        from datetime import datetime
        date_str = datetime.fromtimestamp(t_date/1000).strftime('%Y-%m-%d')
        print(f'       2004: {date_str} C={result.get(\"c\")} V={result.get(\"v\")}')
    
    time.sleep(0.08)
    print()
`\""
```


```py
# d:\TSIS_SmallCaps\test_missing_tickers.py
import requests
import os
import time
from datetime import datetime

api_key = "G4fe7xkLNVEWmWeVHcuXx73P2gfRE6mN"

# Tickers de la lista de missing
test_tickers = ['MED', 'MGN', 'MIW', 'MJI', 'MLR', 'MPB', 'MPX', 'MTS', 'NAT', 'NBG']

print('=== TEST TICKERS MISSING - DISPONIBILIDAD 2004 vs 2011 ===\n')

for ticker in test_tickers:
    # Test 2004
    url_2004 = f'https://api.polygon.io/v2/aggs/ticker/{ticker}/range/1/day/2004-01-02/2004-01-10'
    r_2004 = requests.get(url_2004, params={'apiKey': api_key}, timeout=10)
    data_2004 = r_2004.json()
    count_2004 = data_2004.get('resultsCount', 0)

    time.sleep(0.08)

    # Test 2011
    url_2011 = f'https://api.polygon.io/v2/aggs/ticker/{ticker}/range/1/day/2011-10-17/2011-10-25'
    r_2011 = requests.get(url_2011, params={'apiKey': api_key}, timeout=10)
    data_2011 = r_2011.json()
    count_2011 = data_2011.get('resultsCount', 0)

    print(f'{ticker:6} | 2004: {count_2004:2} días | 2011: {count_2011:2} días | Status: {data_2004.get("status", "ERROR")}')

    # Si hay datos en 2004, mostrar el primer precio
    if count_2004 > 0 and 'results' in data_2004:
        result = data_2004['results'][0]
        t_date = result.get('t', 0)
        date_str = datetime.fromtimestamp(t_date/1000).strftime('%Y-%m-%d')
        print(f'       2004: {date_str} C={result.get("c")} V={result.get("v")}')

    # Si hay datos en 2011, mostrar el primer precio
    if count_2011 > 0 and 'results' in data_2011:
        result = data_2011['results'][0]
        t_date = result.get('t', 0)
        date_str = datetime.fromtimestamp(t_date/1000).strftime('%Y-%m-%d')
        print(f'       2011: {date_str} C={result.get("c")} V={result.get("v")}')

    time.sleep(0.08)
    print()
```

=== TEST TICKERS MISSING - DISPONIBILIDAD 2004 vs 2011 ===

MED    | 2004:  6 d�as | 2011:  7 d�as | Status: OK
       2004: 2004-01-02 C=13.99 V=83700
       2011: 2011-10-17 C=16.15 V=386034

MGN    | 2004:  0 d�as | 2011:  7 d�as | Status: OK
       2011: 2011-10-17 C=1.73 V=25995

MIW    | 2004:  5 d�as | 2011:  6 d�as | Status: OK
       2004: 2004-01-02 C=15.9 V=100
       2011: 2011-10-17 C=14.11 V=761

MJI    | 2004:  6 d�as | 2011:  7 d�as | Status: OK
       2004: 2004-01-02 C=15.1 V=8900
       2011: 2011-10-17 C=13.698 V=9430

MLR    | 2004:  6 d�as | 2011:  7 d�as | Status: OK
       2004: 2004-01-02 C=7.44 V=50200
       2011: 2011-10-17 C=18.51 V=84481

MPB    | 2004:  0 d�as | 2011:  0 d�as | Status: OK

MPX    | 2004:  6 d�as | 2011:  7 d�as | Status: OK
       2004: 2004-01-02 C=8.1645 V=19125
       2011: 2011-10-17 C=4.37 V=18322

MTS    | 2004:  6 d�as | 2011:  7 d�as | Status: OK
       2004: 2004-01-02 C=18.55 V=13200
       2011: 2011-10-17 C=15.41 V=3161

NAT    | 2004:  6 d�as | 2011:  7 d�as | Status: OK
       2004: 2004-01-02 C=15.2 V=84100
       2011: 2011-10-17 C=14.24 V=634757

NBG    | 2004:  6 d�as | 2011:  7 d�as | Status: OK
       2004: 2004-01-02 C=20.9231 V=11102
       2011: 2011-10-17 C=2.85 V=565655.6